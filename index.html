<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>QR Puzzle</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body {
    margin:0;
    display:flex;
    align-items:center;
    justify-content:center;
    height:100vh;
    background:#000;
  }
  .puzzle {
    display:grid;
    grid-template-columns: repeat(4, 1fr); /* change 4 â†’ 3 for 3Ã—3 */
    grid-template-rows: repeat(4, 1fr);
    gap:1px;
    width:320px;
    height:320px;
    background:#000;
  }
  .tile {
    background-image:url("qr.png"); /* ðŸ”§ replace with your QR image */
    background-size:320px 320px;
    cursor:pointer;
  }
  .hidden {
    visibility:hidden;
  }
</style>
</head>
<body>
<div class="puzzle" id="puzzle"></div>
<script>
const GRID = 4; // change 4 â†’ 3 for 3Ã—3
const SIZE = 320;
const puzzle = document.getElementById("puzzle");

let order = [...Array(GRID*GRID).keys()];
order.sort(()=>Math.random()-0.5); // shuffle

function build(){
  puzzle.innerHTML="";
  for(let pos=0; pos<order.length; pos++){
    const idx = order[pos];
    const tile = document.createElement("div");
    tile.className="tile";
    tile.style.backgroundPosition = 
      `${-(idx%GRID)*(SIZE/GRID)}px ${-Math.floor(idx/GRID)*(SIZE/GRID)}px`;
    tile.style.width = SIZE/GRID+"px";
    tile.style.height = SIZE/GRID+"px";
    tile.dataset.pos=pos;
    tile.dataset.idx=idx;
    tile.addEventListener("click",onTap);
    puzzle.appendChild(tile);
  }
}

let sel=null;
function onTap(e){
  const t=e.target;
  if(!sel){ sel=t; sel.style.outline="2px solid lime"; return; }
  // swap idx
  const tmp=sel.dataset.idx;
  sel.dataset.idx=t.dataset.idx;
  t.dataset.idx=tmp;
  // swap bg positions
  const tmpPos=sel.style.backgroundPosition;
  sel.style.backgroundPosition=t.style.backgroundPosition;
  t.style.backgroundPosition=tmpPos;
  sel.style.outline=""; sel=null;
  checkSolved();
}

function checkSolved(){
  const tiles=[...puzzle.children];
  for(let i=0;i<tiles.length;i++){
    if(tiles[i].dataset.idx!=i) return;
  }
  alert("âœ… Puzzle solved! Scan the QR.");
}

build();
</script>
</body>
</html>
